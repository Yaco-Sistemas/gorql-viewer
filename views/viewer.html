<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Data Viewer</title>
    <link href='http://fonts.googleapis.com/css?family=Droid+Serif' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/stylesheets/style.css" />

    <!--{{partial(chart) "debug"}}-->

    {{if chart && !chart.png}}
    <script type="text/javascript" src="/javascripts/dv-core.js"></script>
    {{if chart.family == 'd3'}}
    <script type="text/javascript" src="/javascripts/dv-d3.js"></script>
    {{else}} {{if chart.family == 'simile'}}
    <script type="text/javascript" src="/javascripts/dv-time.js"></script>
    {{else}} {{if chart.family == 'layers'}}
    <script type="text/javascript" src="/javascripts/dv-openlayers.js"></script>
    {{/if}}{{/if}}{{/if}}
    <script type="text/javascript">
        DomReady.ready(function () {
            DV.${chart.type}("#dv_viewport",
                "#dv_table",
                {
                    {{each(idx, option) chart.options}}{{if idx != 0}}, {{/if}}${option[0]}: "${option[1]}"{{/each}}
                });
        });
    </script>
    <link rel="stylesheet" href="/stylesheets/${chart.type}.css" />
    {{/if}}
</head>
<body>
    {{if error}}
    <section>
        <h1>Something wrong happened</h1>
        <div id="error">${error}</div>
    </section>
    {{else}}

    {{if chart}}
    <section>
        <h1 class="first">${chart.type} Chart</h1>
        <div id="dv_viewport" class="dv_viewport">
        {{if chart.png && chart.family == 'd3'}}<img src="/png/?query=${encoded_query}&chart=${chart.type}" />{{/if}}
        </div>
    </section>
    {{/if}}

    <section>
        <h1 {{if !chart}}class="first"{{/if}}>Data</h1>
        {{html table}}
    </section>

    <section>
        <h1>Query</h1>
        <pre id="dv_query"><code class="language-sparql">${query}</code></pre>
    </section>
    {{/if}}
</body>
</html>