<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Data Viewer</title>
    <link rel="stylesheet" href="/stylesheets/style.css" />
    {{if chart && !chart.png}}
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="/javascripts/d3.js"></script>
    <script type="text/javascript" src="/javascripts/${chart.type}.js"></script>
    <link rel="stylesheet" href="/stylesheets/${chart.type}.css" />
    <script type="text/javascript">
        $(document).ready(function () {
            DV.chart("#dv_viewport",
                [{{each(idx, value) chart.data.labels}}{{if idx != 0}}, {{/if}}"${value}"{{/each}}],
                [{{each(idx, value) chart.data.values}}{{if idx != 0}}, {{/if}}${value}{{/each}}],
                {
                    landscape: ${chart.landscape},
                    sizeX: ${chart.sizeX},
                    sizeY:${chart.sizeY}
                });
        });
    </script>
    {{/if}}
</head>
<body>
    <h1>Data Viewer</h1>
    {{if error}}
    <div id="error">${error}</div>
    {{else}}
    <div id="dv_viewport">
    {{if chart && chart.png}}
    <img src="/png/?query=${encoded_query}&chart=${chart.type}" />
    {{/if}}
    </div>
    <table id="dv_table">
    <thead>
        {{each headers}}
        <th>${$value}</th>
        {{/each}}
    </thead>
    <tbody>
        {{each results}}
        <tr>
            {{each $value}}
            <td>${$value}</td>
            {{/each}}
        </tr>
        {{/each}}
    </tbody>
    </table>
    <pre id="dv_query">
    ${query}
    </pre>
    {{/if}}
</body>
</html>